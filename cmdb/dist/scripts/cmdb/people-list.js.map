{"version":3,"sources":["cmdb/people-list.js"],"names":["CMDB_API","queryDictionary","add","delete","update","column","query","export","import","META","label","required","maxLength","type","options","EDIT_FIELDS","SEARCH_TOOLS","selectAry","createData","item","$","each","i","e","j","length","select","WUI","ModalDialog","create","buttonHide","dataDialog","$el","dialogPop","meta","list","onConfirm","submitData","bind","fields","queryData","_beforeSend","request","setRequestHeader","currentPage","pageSize","getCookie","ajax","url","DOMAIN","CMDB","method","jsonData","queryJson","disableXSS","beforeSend","then","resp","DataTable","TABLE_FIELDS","operations","name","callback","deleteData","groups","className","id","DataPaginator","total","totalCount","onSwitchPage","ready","ContentHeader","init","system"],"mappings":"AAAA,YAEA,IAAIA,WACFC,gBAAiB,uBACjBC,IAAK,iBACLC,SAAQ,qBACRC,OAAQ,oBACRC,OAAQ,qBACRC,MAAO,oBACPC,SAAQ,6BACRC,SAAQ,2BAEVC,MAAW,MAAMC,MAAO,MAAOC,UAAU,EAAMC,UAAU,IACzDH,KAAW,MAAMC,MAAO,KAAME,UAAU,IACxCH,KAAY,OAAMC,MAAO,KAAME,UAAU,IACzCH,KAAW,MAAMC,MAAO,KAAME,UAAU,IACxCH,KAAW,MAAMC,MAAO,KAAMG,KAAM,SAAUC,YAC9CL,KAAe,UAAMC,MAAO,KAAME,UAAU,IAC5CH,KAAgB,WAAMC,MAAO,OAAQE,UAAU,GAC/C,IAAIG,cAAe,OAAQ,OAAQ,QAAS,OAAQ,WAAY,YAAa,SAAU,OAAQ,cAC/FC,gBAEA,IAAIC,YAAa,SAAU,QACvBC,WAAa,SAAUC,GAEzBC,EAAEC,KAAKJ,UAAU,SAASK,EAAGC,GAC3B,IAAI,GAAIC,GAAE,EAAEA,EAAEf,KAAKc,GAAGT,QAAQW,OAAOD,IAC/Bf,KAAKc,GAAGT,QAAQU,GAAGd,OAASS,EAAKI,GACnCd,KAAKc,GAAGT,QAAQU,GAAGE,QAAS,EAE5BjB,KAAKc,GAAGT,QAAQU,GAAGE,QAAS,IAKlCC,IAAIC,YAAYC,QACdC,YAAY,IAGdH,IAAII,WAAWF,QACbG,IAAKZ,EAAE,eACPa,WAAU,EACVC,KAAMzB,KACN0B,KAAMhB,EACNW,YAAY,EACZM,UAAWC,WAAWC,KAAK,KAAMnB,GACjCoB,OAAQxB,cAGZyB,WAAY,SAAU1B,GACpB,GAAI2B,GAAc,SAASC,GACzBA,EAAQC,iBAAiB,UAAW7B,EAAQ8B,aAC5CF,EAAQC,iBAAiB,YAAa7B,EAAQ+B,UAC9CH,EAAQC,iBAAiB,gBAAiBG,UAAU,mBAAoB,IAAKA,UAAU,eAGzFnB,KAAIoB,MACFC,IAAKC,OAAOC,KAAOlD,SAASM,MAC5B6C,OAAQ,OACRC,SAAUC,YACVC,YAAY,EACZC,WAAYd,IACXe,KAAK,SAAUC,GAChB9B,IAAI+B,UAAU7B,QACZG,IAAKZ,EAAE,eACPc,KAAMzB,KACN8B,OAAQoB,aACRxB,KAAMsB,EAAKtB,KACXyB,aACEC,KAAM,KACNC,SAAU5C,aAEV2C,KAAM,KACNC,SAAUC,aAEZC,SACEH,KAAM,OACNI,UAAW,wBACXC,GAAI,aACJJ,SAAUC,eAIdpC,IAAIwC,cAActC,QAChBG,IAAKZ,EAAE,mBACPwB,YAAa9B,EAAQ8B,YAAc,EACnCwB,MAAOX,EAAKY,WACZxB,SAAU/B,EAAQ+B,SAClByB,aAAc,SAAU1B,GACtBJ,WACEI,YAAaA,EAAc,EAC3BC,SAAU/B,EAAQ+B,iBAQ5BlB,IAAI4C,MAAQ,WAEVtE,gBAAgB,UAGhB0B,IAAI6C,cAAc3C,QAChBG,IAAKZ,EAAE,mBACPc,OACE2B,KAAM,UAKZzC,EAAE,WACAO,IAAI8C,MACFC,OAAQ","file":"people-list.js","sourcesContent":["'use strict';\n// Constants\nvar CMDB_API = {\n  queryDictionary: '/web/queryDictionary', // 数据字典\n  add: '/web/addPeople', // 增\n  delete: '/web/deletePeoples', // 删\n  update: '/web/updatePeople', // 改\n  column: '/web/people/column', // 查询条件\n  query: '/web/people/query', // 查\n  export: '/web/excel/download/people', // export\n  import: '/web/excel/upload/people' // import\n};\nMETA['code'] = { label: '用户名', required: true, maxLength:30 };\nMETA['name'] = { label: '姓名', maxLength:30 };\nMETA['phone'] = { label: '电话', maxLength:30 };\nMETA['mail'] = { label: '邮箱', maxLength:30 };\nMETA['type'] = { label: '类型', type: 'select', options: [] };\nMETA['password'] = { label: '密码', maxLength:30 };\nMETA['password2'] = { label: '确认密码', maxLength:30 };\nvar EDIT_FIELDS = ['code', 'name', 'phone', 'mail', 'password', 'password2', 'status', 'type', 'description'];\nSEARCH_TOOLS = [];\n\nvar selectAry = ['status', 'type'];\nvar createData = function (item) {\n  // 初始化select\n  $.each(selectAry,function(i, e){\n    for(var j=0;j<META[e].options.length;j++){\n      if (META[e].options[j].label == item[e]) {\n        META[e].options[j].select = true;\n      } else {\n        META[e].options[j].select = false;\n      }\n    }\n  });\n\n  WUI.ModalDialog.create({\n    buttonHide: true,\n  });\n\n  WUI.dataDialog.create({\n    $el: $('.modal-body'),\n    dialogPop:true,\n    meta: META,\n    list: item,\n    buttonHide: false,\n    onConfirm: submitData.bind(null, item),\n    fields: EDIT_FIELDS\n  });\n};\nqueryData = function (options) {\n  var _beforeSend = function(request) {\n    request.setRequestHeader(\"pageNum\", options.currentPage);\n    request.setRequestHeader(\"pageLimit\", options.pageSize);\n    request.setRequestHeader(\"Authorization\", getCookie('CMDB-TOKEN-TYPE') +' '+ getCookie('CMDB-TOKEN'));\n  };\n  \n  WUI.ajax({\n    url: DOMAIN.CMDB + CMDB_API.query,\n    method: 'POST',\n    jsonData: queryJson(),\n    disableXSS: true,\n    beforeSend: _beforeSend\n  }).then(function (resp) {\n    WUI.DataTable.create({\n      $el: $('.data-table'),\n      meta: META,\n      fields: TABLE_FIELDS,\n      list: resp.list,\n      operations: [{\n        name: '编辑',\n        callback: createData\n      }, {\n        name: '删除',\n        callback: deleteData\n      }],\n      groups: [{\n        name: '批量删除',\n        className: 'btn btn-xs btn-danger',\n        id: 'btn-danger',\n        callback: deleteData\n      }]\n    });\n\n    WUI.DataPaginator.create({\n      $el: $('.data-paginator'),\n      currentPage: options.currentPage - 1,\n      total: resp.totalCount,\n      pageSize: options.pageSize,\n      onSwitchPage: function (currentPage) {\n        queryData({\n          currentPage: currentPage + 1,\n          pageSize: options.pageSize\n        });\n      }\n    });\n  });\n};\n\n// Load Page\nWUI.ready = function () {\n  // meta的元素数据字典 => cloumn数据 => 查询数据\n  queryDictionary('people');\n\n  // 面包屑\n  WUI.ContentHeader.create({\n    $el: $('.content-header'),\n    meta: [{\n      name: '人员'\n    }]\n  });\n}\n// Keep this function\n$(function () {\n  WUI.init({\n    system: 'cmdb'\n  });\n});\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJjbWRiL3Blb3BsZS1saXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbi8vIENvbnN0YW50c1xudmFyIENNREJfQVBJID0ge1xuICBxdWVyeURpY3Rpb25hcnk6ICcvd2ViL3F1ZXJ5RGljdGlvbmFyeScsIC8vIOaVsOaNruWtl+WFuFxuICBhZGQ6ICcvd2ViL2FkZFBlb3BsZScsIC8vIOWinlxuICBkZWxldGU6ICcvd2ViL2RlbGV0ZVBlb3BsZXMnLCAvLyDliKBcbiAgdXBkYXRlOiAnL3dlYi91cGRhdGVQZW9wbGUnLCAvLyDmlLlcbiAgY29sdW1uOiAnL3dlYi9wZW9wbGUvY29sdW1uJywgLy8g5p+l6K+i5p2h5Lu2XG4gIHF1ZXJ5OiAnL3dlYi9wZW9wbGUvcXVlcnknLCAvLyDmn6VcbiAgZXhwb3J0OiAnL3dlYi9leGNlbC9kb3dubG9hZC9wZW9wbGUnLCAvLyBleHBvcnRcbiAgaW1wb3J0OiAnL3dlYi9leGNlbC91cGxvYWQvcGVvcGxlJyAvLyBpbXBvcnRcbn07XG5NRVRBWydjb2RlJ10gPSB7IGxhYmVsOiAn55So5oi35ZCNJywgcmVxdWlyZWQ6IHRydWUsIG1heExlbmd0aDozMCB9O1xuTUVUQVsnbmFtZSddID0geyBsYWJlbDogJ+Wnk+WQjScsIG1heExlbmd0aDozMCB9O1xuTUVUQVsncGhvbmUnXSA9IHsgbGFiZWw6ICfnlLXor50nLCBtYXhMZW5ndGg6MzAgfTtcbk1FVEFbJ21haWwnXSA9IHsgbGFiZWw6ICfpgq7nrrEnLCBtYXhMZW5ndGg6MzAgfTtcbk1FVEFbJ3R5cGUnXSA9IHsgbGFiZWw6ICfnsbvlnosnLCB0eXBlOiAnc2VsZWN0Jywgb3B0aW9uczogW10gfTtcbk1FVEFbJ3Bhc3N3b3JkJ10gPSB7IGxhYmVsOiAn5a+G56CBJywgbWF4TGVuZ3RoOjMwIH07XG5NRVRBWydwYXNzd29yZDInXSA9IHsgbGFiZWw6ICfnoa7orqTlr4bnoIEnLCBtYXhMZW5ndGg6MzAgfTtcbnZhciBFRElUX0ZJRUxEUyA9IFsnY29kZScsICduYW1lJywgJ3Bob25lJywgJ21haWwnLCAncGFzc3dvcmQnLCAncGFzc3dvcmQyJywgJ3N0YXR1cycsICd0eXBlJywgJ2Rlc2NyaXB0aW9uJ107XG5TRUFSQ0hfVE9PTFMgPSBbXTtcblxudmFyIHNlbGVjdEFyeSA9IFsnc3RhdHVzJywgJ3R5cGUnXTtcbnZhciBjcmVhdGVEYXRhID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgLy8g5Yid5aeL5YyWc2VsZWN0XG4gICQuZWFjaChzZWxlY3RBcnksZnVuY3Rpb24oaSwgZSl7XG4gICAgZm9yKHZhciBqPTA7ajxNRVRBW2VdLm9wdGlvbnMubGVuZ3RoO2orKyl7XG4gICAgICBpZiAoTUVUQVtlXS5vcHRpb25zW2pdLmxhYmVsID09IGl0ZW1bZV0pIHtcbiAgICAgICAgTUVUQVtlXS5vcHRpb25zW2pdLnNlbGVjdCA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBNRVRBW2VdLm9wdGlvbnNbal0uc2VsZWN0ID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICBXVUkuTW9kYWxEaWFsb2cuY3JlYXRlKHtcbiAgICBidXR0b25IaWRlOiB0cnVlLFxuICB9KTtcblxuICBXVUkuZGF0YURpYWxvZy5jcmVhdGUoe1xuICAgICRlbDogJCgnLm1vZGFsLWJvZHknKSxcbiAgICBkaWFsb2dQb3A6dHJ1ZSxcbiAgICBtZXRhOiBNRVRBLFxuICAgIGxpc3Q6IGl0ZW0sXG4gICAgYnV0dG9uSGlkZTogZmFsc2UsXG4gICAgb25Db25maXJtOiBzdWJtaXREYXRhLmJpbmQobnVsbCwgaXRlbSksXG4gICAgZmllbGRzOiBFRElUX0ZJRUxEU1xuICB9KTtcbn07XG5xdWVyeURhdGEgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICB2YXIgX2JlZm9yZVNlbmQgPSBmdW5jdGlvbihyZXF1ZXN0KSB7XG4gICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKFwicGFnZU51bVwiLCBvcHRpb25zLmN1cnJlbnRQYWdlKTtcbiAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoXCJwYWdlTGltaXRcIiwgb3B0aW9ucy5wYWdlU2l6ZSk7XG4gICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKFwiQXV0aG9yaXphdGlvblwiLCBnZXRDb29raWUoJ0NNREItVE9LRU4tVFlQRScpICsnICcrIGdldENvb2tpZSgnQ01EQi1UT0tFTicpKTtcbiAgfTtcbiAgXG4gIFdVSS5hamF4KHtcbiAgICB1cmw6IERPTUFJTi5DTURCICsgQ01EQl9BUEkucXVlcnksXG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAganNvbkRhdGE6IHF1ZXJ5SnNvbigpLFxuICAgIGRpc2FibGVYU1M6IHRydWUsXG4gICAgYmVmb3JlU2VuZDogX2JlZm9yZVNlbmRcbiAgfSkudGhlbihmdW5jdGlvbiAocmVzcCkge1xuICAgIFdVSS5EYXRhVGFibGUuY3JlYXRlKHtcbiAgICAgICRlbDogJCgnLmRhdGEtdGFibGUnKSxcbiAgICAgIG1ldGE6IE1FVEEsXG4gICAgICBmaWVsZHM6IFRBQkxFX0ZJRUxEUyxcbiAgICAgIGxpc3Q6IHJlc3AubGlzdCxcbiAgICAgIG9wZXJhdGlvbnM6IFt7XG4gICAgICAgIG5hbWU6ICfnvJbovpEnLFxuICAgICAgICBjYWxsYmFjazogY3JlYXRlRGF0YVxuICAgICAgfSwge1xuICAgICAgICBuYW1lOiAn5Yig6ZmkJyxcbiAgICAgICAgY2FsbGJhY2s6IGRlbGV0ZURhdGFcbiAgICAgIH1dLFxuICAgICAgZ3JvdXBzOiBbe1xuICAgICAgICBuYW1lOiAn5om56YeP5Yig6ZmkJyxcbiAgICAgICAgY2xhc3NOYW1lOiAnYnRuIGJ0bi14cyBidG4tZGFuZ2VyJyxcbiAgICAgICAgaWQ6ICdidG4tZGFuZ2VyJyxcbiAgICAgICAgY2FsbGJhY2s6IGRlbGV0ZURhdGFcbiAgICAgIH1dXG4gICAgfSk7XG5cbiAgICBXVUkuRGF0YVBhZ2luYXRvci5jcmVhdGUoe1xuICAgICAgJGVsOiAkKCcuZGF0YS1wYWdpbmF0b3InKSxcbiAgICAgIGN1cnJlbnRQYWdlOiBvcHRpb25zLmN1cnJlbnRQYWdlIC0gMSxcbiAgICAgIHRvdGFsOiByZXNwLnRvdGFsQ291bnQsXG4gICAgICBwYWdlU2l6ZTogb3B0aW9ucy5wYWdlU2l6ZSxcbiAgICAgIG9uU3dpdGNoUGFnZTogZnVuY3Rpb24gKGN1cnJlbnRQYWdlKSB7XG4gICAgICAgIHF1ZXJ5RGF0YSh7XG4gICAgICAgICAgY3VycmVudFBhZ2U6IGN1cnJlbnRQYWdlICsgMSxcbiAgICAgICAgICBwYWdlU2l6ZTogb3B0aW9ucy5wYWdlU2l6ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG4vLyBMb2FkIFBhZ2VcbldVSS5yZWFkeSA9IGZ1bmN0aW9uICgpIHtcbiAgLy8gbWV0YeeahOWFg+e0oOaVsOaNruWtl+WFuCA9PiBjbG91bW7mlbDmja4gPT4g5p+l6K+i5pWw5o2uXG4gIHF1ZXJ5RGljdGlvbmFyeSgncGVvcGxlJyk7XG5cbiAgLy8g6Z2i5YyF5bGRXG4gIFdVSS5Db250ZW50SGVhZGVyLmNyZWF0ZSh7XG4gICAgJGVsOiAkKCcuY29udGVudC1oZWFkZXInKSxcbiAgICBtZXRhOiBbe1xuICAgICAgbmFtZTogJ+S6uuWRmCdcbiAgICB9XVxuICB9KTtcbn1cbi8vIEtlZXAgdGhpcyBmdW5jdGlvblxuJChmdW5jdGlvbiAoKSB7XG4gIFdVSS5pbml0KHtcbiAgICBzeXN0ZW06ICdjbWRiJ1xuICB9KTtcbn0pO1xuIl0sImZpbGUiOiJjbWRiL3Blb3BsZS1saXN0LmpzIn0=\n"]}