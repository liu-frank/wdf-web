function login(){var e=$.trim($("#username-input").val()),t=$.trim($("#password-input").val());e?t?($(".error-message").text("").hide(),$.ajax({url:DOMAIN.CMDB+"/oauth/token?grant_type=password&username=cmdb&password=cmdb",contentType:"application/json",dataType:"json",username:e,password:t,type:"POST"}).then(function(t){console.log(t.expires_in+10),setCookie("CMDB-TOKEN",t.access_token,t.expires_in+10),setCookie("CMDB-TOKEN-TYPE",t.token_type,t.expires_in+10),setCookie("CMDB-USERNAME",e,t.expires_in+10),window.location.href="/cmdb/home.html"}).fail(function(e){$(".error-message").text("帐号或密码不正确，请确认").show()})):$(".error-message").text("密码不能为空，请输入").show():$(".error-message").text("帐号不能为空，请输入").show()}function setCookie(e,t,a,r,o,i){var n=new Date;n.setTime(n.getTime()),a&&(a=1e3*a);var s=new Date(n.getTime()+a);document.cookie=e+"="+escape(t)+(a?";expires="+s.toGMTString():"")+(r?";path="+r:"")+(o?";domain="+o:"")+(i?";secure":"")}!function(e){function t(){var e=document.createElement("input");return"placeholder"in e}var a={focus:function(t){t=e(t).hide().prev().show().focus();var a=t.attr("id");a&&t.attr("id",a.replace("placeholderfriend",""));var r=t.attr("class");r&&t.attr("class",r.replace("placeholderfriend",""))}};t()||e(function(){var t=e(this),a=t.find("input[type='text'][placeholder]");a.each(function(){var t=e(this),a=t.attr("placeholder"),r=t.val();a&&""==r&&t.val(a)}),a.focus(function(){var t=e(this),a=t.attr("placeholder"),r=t.val();r&&a&&r==a&&t.val("")}),a.blur(function(){var t=e(this),a=t.attr("placeholder"),r=t.val();r||t.val(a)});var r=t.find("input[type='password'][placeholder]");r.each(function(t){var a=e(this),r=a.attr("placeholder"),o=a.val();if(r&&""==o){var i=this.outerHTML||"";i=i.replace(/\s*type=(['"])?password\1/gi," type=text placeholderfriend").replace(/\s*(?:value|on[a-z]+|name)(=(['"])?\S*\1)?/gi," ").replace(/\s*placeholderfriend/," placeholderfriend value='"+r+"' onfocus='placeholderfriendfocus(this);' ");var n=a.attr("id");n&&a.attr("id",n+"placeholderfriend");var s=a.attr("class");s&&a.attr("class",s+"placeholderfriend"),a.hide(),a.after(i)}}),r.blur(function(){var t=e(this),a=t.val();if(""==a){var r=t.attr("id");r&&t.attr("id",r+"placeholderfriend");var o=t.attr("class");o&&t.attr("class",o+"placeholderfriend"),t.hide().next().show()}})}),window.placeholderfriendfocus=a.focus,e(".submit-button").click(function(){login()}),e(document).keyup(function(e){13==e.keyCode&&login()})}(jQuery);var DOMAIN={CMDB:""};7==window.location.href.indexOf("127.0.0.1")&&(DOMAIN.CMDB="http://cmdb.api.dev.wanda.com");
//# sourceMappingURL=login.js.map
