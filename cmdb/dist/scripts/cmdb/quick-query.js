"use strict";var CMDB_API={query:"/web/ex/getAllConfigurationDevicesByValue","export":"/web/excel/download/rack"};SEARCH_TOOLS=[{label:"工具",options:[{rowHtml:'<a href="http://10.214.124.55/zabbix/" target="_blank">zabbix</a>'},{rowHtml:'<a href="http://10.214.124.53:8080/" target="_blank">Jira</a>'},{rowHtml:'<a href="http://10.214.124.53:8090/" target="_blank">Confluence</a>'},{rowHtml:'<a href="http://10.214.124.53/itop/" target="_blank">Itop</a>'},{rowHtml:'<a href="http://10.214.66.75/" target="_blank">ELK</a>'},{rowHtml:'<a href="http://10.214.124.57/svnadmin/" target="_blank">Svn</a>'},{rowHtml:'<a href="http://10.214.124.57:8081/" target="_blank">GitLab</a>'},{rowHtml:'<a href="http://10.214.124.58:8080/" target="_blank">Jenkins</a>'},{rowHtml:'<a href="http://10.214.124.56:8081/nexus/" target="_blank">Nexus</a>'},{rowHtml:'<a href="https://10.214.124.59/" target="_blank">Ansible</a>'},{rowHtml:'<a href="https://10.214.124.59/" target="_blank">Ansible</a>'}]}],META.table={label:"Table",maxLength:30},META.tableDisplayName={label:"配置项",maxLength:30},META.code={label:"Code",maxLength:30},META.rack_code={label:"IDC_code",maxLength:30},META.environment={label:"版本",maxLength:30},META.computer_amount={label:"规格（U）",maxLength:30},META.cloud_type={label:"类型",maxLength:30},META.type={label:"接口",maxLength:30},META.insure={label:"保障",maxLength:30},META.net_type1={label:"type",maxLength:30},META.net_type2={label:"type",maxLength:30},META.net_type3={label:"type",maxLength:30},META.net_type4={label:"type",maxLength:30},META.net_type5={label:"type",maxLength:30},META.net_type6={label:"type",maxLength:30},META.net_type7={label:"type",maxLength:30},META.net_type8={label:"type",maxLength:30},META.net_type9={label:"type",maxLength:30},META.os_family={label:"OS family",maxLength:30},META.os_version={label:"OS version",maxLength:30},META.status={label:"状态",maxLength:30},META.allocated={label:"分配状态",maxLength:30},META.purchase_time={label:"采购时间",maxLength:30},META.arrival_time={label:"到货时间",maxLength:30},META.stock_time={label:"上线时间",maxLength:30},META.maintain_time_begin={label:"维保开始时间",maxLength:30},META.maintain_time_end={label:"维保结束时间",maxLength:30},META.created_time={label:"创建时间",maxLength:30},META.updated_time={label:"更新时间",maxLength:30},META.alloc_deadline={label:"分配截止时间",maxLength:30};var TABLE_FIELDS=["tableDisplayName","code","stock_time","status"],VIEW_FIELDS_IDC=["code","location","rack_region","rack","status","computer_amount","description"],VIEW_FIELDS_SERVER_BASIC=["code","rack_code","serial_number","cloud_type","cpu","model","memory","raid","harddisk","computer_amount","u_amount","typical_case","manage_ip","hostname","optional"],VIEW_FIELDS_SERVER_NET=["net_name1","net_type1","net_ip1","net_name2","net_type2","net_ip2","net_name3","net_type3","net_ip3","net_name4","net_type4","net_ip4","net_name5","net_type5","net_ip5","net_name6","net_type6","net_ip6","net_name7","net_type7","net_ip7","net_name8","net_type8","net_ip8","net_name9","net_type9","net_ip9"],VIEW_FIELDS_SERVER_OS=["os_family","os_version"],VIEW_FIELDS_SERVER_OTHER=["status","allocated","alloc_deadline","purchase_time","arrival_time","stock_time","maintain_time_begin","maintain_time_end","description"],VIEW_FIELDS_VM_BASIC=["code","server_code","cpu","cloud_type","memory","harddisk","hostname","optional"],VIEW_FIELDS_VM_NET=["net_name1","net_type1","net_ip1","net_name2","net_type2","net_ip2","net_name3","net_type3","net_ip3","net_name4","net_type4","net_ip4","net_name5","net_type5","net_ip5","net_name6","net_type6","net_ip6","net_name7","net_type7","net_ip7","net_name8","net_type8","net_ip8","net_name9","net_type9","net_ip9"],VIEW_FIELDS_VM_OS=["os_family","os_version"],VIEW_FIELDS_VM_OTHER=["status","allocated","alloc_deadline","stock_time","description"],VIEW_FIELDS_DEVICE_BASIC=["code","rack_code","model","cloud_type","serial_number","name","type","computer_amount","manage_ip","optional"],VIEW_FIELDS_DEVICE_OTHER=["purchase_time","arrival_time","stock_time","maintain_time_begin","maintain_time_end","status","description"],VIEW_FIELDS_PROJECT=["code","name","version","stock_time","insure","description"],viewData=function(e){switch(WUI.ModalDialog.create({buttonHide:!0}),META.stock_time.label="上架时间",e.table){case"rack":WUI.dataDialog.create({$el:$(".modal-body"),meta:META,list:e,buttonHide:!0,fields:VIEW_FIELDS_IDC});break;case"server":$(".modal-body").append("<h4>基础信息</h6>"),WUI.dataDialog.create({$el:$(".modal-body"),meta:META,list:e,buttonHide:!0,fields:VIEW_FIELDS_SERVER_BASIC,htmlAppend:!0}),$(".modal-body").append("<h4>网络信息</h6>"),WUI.dataDialog.create({$el:$(".modal-body"),meta:META,list:e,buttonHide:!0,fields:VIEW_FIELDS_SERVER_NET,htmlAppend:!0}),$(".modal-body").append("<h4>OS信息</h6>"),WUI.dataDialog.create({$el:$(".modal-body"),meta:META,list:e,buttonHide:!0,fields:VIEW_FIELDS_SERVER_OS,htmlAppend:!0}),$(".modal-body").append("<h4>其他信息</h6>"),WUI.dataDialog.create({$el:$(".modal-body"),meta:META,list:e,buttonHide:!0,fields:VIEW_FIELDS_SERVER_OTHER,htmlAppend:!0});break;case"vm":$(".modal-body").append("<h4>基础信息</h6>"),WUI.dataDialog.create({$el:$(".modal-body"),meta:META,list:e,buttonHide:!0,fields:VIEW_FIELDS_VM_BASIC,htmlAppend:!0}),$(".modal-body").append("<h4>网络信息</h6>"),WUI.dataDialog.create({$el:$(".modal-body"),meta:META,list:e,buttonHide:!0,fields:VIEW_FIELDS_VM_NET,htmlAppend:!0}),$(".modal-body").append("<h4>OS信息</h6>"),WUI.dataDialog.create({$el:$(".modal-body"),meta:META,list:e,buttonHide:!0,fields:VIEW_FIELDS_VM_OS,htmlAppend:!0}),$(".modal-body").append("<h4>其他信息</h6>"),WUI.dataDialog.create({$el:$(".modal-body"),meta:META,list:e,buttonHide:!0,fields:VIEW_FIELDS_VM_OTHER,htmlAppend:!0});break;case"device":$(".modal-body").append("<h4>基础信息</h6>"),WUI.dataDialog.create({$el:$(".modal-body"),meta:META,list:e,buttonHide:!0,fields:VIEW_FIELDS_DEVICE_BASIC,htmlAppend:!0}),$(".modal-body").append("<h4>其他信息</h6>"),WUI.dataDialog.create({$el:$(".modal-body"),meta:META,list:e,buttonHide:!0,fields:VIEW_FIELDS_DEVICE_OTHER,htmlAppend:!0});break;case"project":META.stock_time.label="上线时间",WUI.dataDialog.create({$el:$(".modal-body"),meta:META,list:e,buttonHide:!0,fields:VIEW_FIELDS_PROJECT})}$(".quick-query .modal-body input").prop("readonly",!0)};queryData=function(e){var t=function(t){t.setRequestHeader("pageNum",e.currentPage),t.setRequestHeader("pageLimit",e.pageSize),t.setRequestHeader("Authorization",getCookie("CMDB-TOKEN-TYPE")+" "+getCookie("CMDB-TOKEN"))},a=$.trim($("input.data-search-des").val()),n=[];$.each($(".quick-query-left input:checked"),function(e,t){var a=$(this),l=a.parents("ul").prev("p").text(),i=a.parent().text(),o=l+" : "+i;n.push(o)}),WUI.ajax({url:DOMAIN.CMDB+CMDB_API.query+"?value="+a+"&labels="+n.join(","),method:"POST",beforeSend:t}).then(function(t){WUI.DataTable.create({$el:$(".data-table"),meta:META,fields:TABLE_FIELDS,list:t.list,operations:[{name:"查看详情",callback:viewData}]}),WUI.DataPaginator.create({$el:$(".data-paginator"),currentPage:e.currentPage-1,total:t.totalCount,pageSize:e.pageSize,onSwitchPage:function(t){queryData({currentPage:t+1,pageSize:e.pageSize})}})})};var queryLabel=function(){WUI.ajax({url:DOMAIN.CMDB+"/web/label/ex/queryLabel",method:"POST"}).then(function(e){var t=[];t.push("<h4>标签<span>清除全部</span></h4>"),$.each(e,function(e,a){t.push("<p><span></span>"+e+"</p>"),t.push("<ul>"),$.each(a,function(e,a){t.push('<li><label><input type="checkbox" />'+a+"</label></li>")}),t.push("</ul>")}),$(".quick-query-left").html(t.join("")),$(".quick-query-left p").click(function(){var e=$(this);e.hasClass("active")?e.removeClass("active"):e.addClass("active")}),$(".quick-query-left > h4 span").click(function(){$(".quick-query-left input[type=checkbox]").prop("checked",!1)})})};WUI.ready=function(){var e={data:[{paths:[],tableName:"",columnName:"description",displayName:"快捷查询",type:"String",dictionaryValues:[],stick:!0}]};WUI.DataSearch.create({$el:$(".content-wrapper .data-search"),meta:e,searchTools:SEARCH_TOOLS?SEARCH_TOOLS:[],queryButton:"查询",onFilter:function(e){queryData($.extend(e,{currentPage:1,pageSize:PAGE_SIZE}))}});var t=decodeURI(WUI.link().key);"undefined"!=t&&$(".data-search-des").val(t),queryLabel(),queryData({currentPage:1,pageSize:PAGE_SIZE}),WUI.ContentHeader.create({$el:$(".content-header"),meta:[{name:"配置项查询"}]})},$(function(){WUI.init({system:"cmdb"})});
//# sourceMappingURL=quick-query.js.map
