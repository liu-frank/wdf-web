{"version":3,"sources":["cmdb/label-list.js"],"names":["CMDB_API","queryDictionary","add","delete","update","column","query","export","import","META","label","required","maxLength","EDIT_FIELDS","selectAry","createData","item","$","each","i","e","j","options","length","select","WUI","ModalDialog","create","buttonHide","dataDialog","$el","dialogPop","meta","list","onConfirm","submitData","bind","fields","queryData","_beforeSend","request","setRequestHeader","currentPage","pageSize","getCookie","ajax","url","DOMAIN","CMDB","method","jsonData","queryJson","disableXSS","beforeSend","then","resp","DataTable","TABLE_FIELDS","operations","name","callback","deleteData","groups","className","id","DataPaginator","total","totalCount","onSwitchPage","ready","ContentHeader","init","system"],"mappings":"AAAA,YAEA,IAAIA,WACFC,gBAAiB,uBACjBC,IAAK,gBACLC,SAAQ,oBACRC,OAAQ,mBACRC,OAAQ,oBACRC,MAAO,mBACPC,SAAQ,4BACRC,SAAQ,0BAEVC,MAAW,MAAMC,MAAO,UAAWC,UAAU,EAAMC,UAAU,GAC7D,IAAIC,cAAe,YAAa,cAAe,SAAU,eAErDC,WAAa,UACbC,WAAa,SAAUC,GAEzBC,EAAEC,KAAKJ,UAAU,SAASK,EAAGC,GAC3B,IAAI,GAAIC,GAAE,EAAEA,EAAEZ,KAAKW,GAAGE,QAAQC,OAAOF,IAC/BZ,KAAKW,GAAGE,QAAQD,GAAGX,OAASM,EAAKI,GACnCX,KAAKW,GAAGE,QAAQD,GAAGG,QAAS,EAE5Bf,KAAKW,GAAGE,QAAQD,GAAGG,QAAS,IAKlCC,IAAIC,YAAYC,QACdC,YAAY,IAGdH,IAAII,WAAWF,QACbG,IAAKb,EAAE,eACPc,WAAU,EACVC,KAAMvB,KACNwB,KAAMjB,EACNY,YAAY,EACZM,UAAWC,WAAWC,KAAK,KAAMpB,GACjCqB,OAAQxB,cAGZyB,WAAY,SAAUhB,GACpB,GAAIiB,GAAc,SAASC,GACzBA,EAAQC,iBAAiB,UAAWnB,EAAQoB,aAC5CF,EAAQC,iBAAiB,YAAanB,EAAQqB,UAC9CH,EAAQC,iBAAiB,gBAAiBG,UAAU,mBAAoB,IAAKA,UAAU,eAGzFnB,KAAIoB,MACFC,IAAKC,OAAOC,KAAOhD,SAASM,MAC5B2C,OAAQ,OACRC,SAAUC,YACVC,YAAY,EACZC,WAAYd,IACXe,KAAK,SAAUC,GAChB9B,IAAI+B,UAAU7B,QACZG,IAAKb,EAAE,eACPe,KAAMvB,KACN4B,OAAQoB,aACRxB,KAAMsB,EAAKtB,KACXyB,aACEC,KAAM,KACNC,SAAU7C,aAEV4C,KAAM,KACNC,SAAUC,aAEZC,SACEH,KAAM,OACNI,UAAW,wBACXC,GAAI,aACJJ,SAAUC,eAIdpC,IAAIwC,cAActC,QAChBG,IAAKb,EAAE,mBACPyB,YAAapB,EAAQoB,YAAc,EACnCwB,MAAOX,EAAKY,WACZxB,SAAUrB,EAAQqB,SAClByB,aAAc,SAAU1B,GACtBJ,WACEI,YAAaA,EAAc,EAC3BC,SAAUrB,EAAQqB,iBAQ5BlB,IAAI4C,MAAQ,WAEVpE,gBAAgB,SAGhBwB,IAAI6C,cAAc3C,QAChBG,IAAKb,EAAE,mBACPe,OACE2B,KAAM,UAKZ1C,EAAE,WACAQ,IAAI8C,MACFC,OAAQ","file":"label-list.js","sourcesContent":["'use strict';\n// Constants\nvar CMDB_API = {\n  queryDictionary: '/web/queryDictionary', // 数据字典\n  add: '/web/addLabel', // 增\n  delete: '/web/deleteLabels', // 删\n  update: '/web/updateLabel', // 改\n  column: '/web/label/column', // 查询条件\n  query: '/web/label/query', // 查\n  export: '/web/excel/download/label', // export\n  import: '/web/excel/upload/label' // import\n};\nMETA['code'] = { label: '标签_code', required: true, maxLength:30 };\nvar EDIT_FIELDS = ['label_key', 'label_value', 'status', 'description'];\n\nvar selectAry = ['status'];\nvar createData = function (item) {\n  // 初始化select\n  $.each(selectAry,function(i, e){\n    for(var j=0;j<META[e].options.length;j++){\n      if (META[e].options[j].label == item[e]) {\n        META[e].options[j].select = true;\n      } else {\n        META[e].options[j].select = false;\n      }\n    }\n  });\n\n  WUI.ModalDialog.create({\n    buttonHide: true,\n  });\n\n  WUI.dataDialog.create({\n    $el: $('.modal-body'),\n    dialogPop:true,\n    meta: META,\n    list: item,\n    buttonHide: false,\n    onConfirm: submitData.bind(null, item),\n    fields: EDIT_FIELDS\n  });\n};\nqueryData = function (options) {\n  var _beforeSend = function(request) {\n    request.setRequestHeader(\"pageNum\", options.currentPage);\n    request.setRequestHeader(\"pageLimit\", options.pageSize);\n    request.setRequestHeader(\"Authorization\", getCookie('CMDB-TOKEN-TYPE') +' '+ getCookie('CMDB-TOKEN'));\n  };\n  \n  WUI.ajax({\n    url: DOMAIN.CMDB + CMDB_API.query,\n    method: 'POST',\n    jsonData: queryJson(),\n    disableXSS: true,\n    beforeSend: _beforeSend\n  }).then(function (resp) {\n    WUI.DataTable.create({\n      $el: $('.data-table'),\n      meta: META,\n      fields: TABLE_FIELDS,\n      list: resp.list,\n      operations: [{\n        name: '编辑',\n        callback: createData\n      }, {\n        name: '删除',\n        callback: deleteData\n      }],\n      groups: [{\n        name: '批量删除',\n        className: 'btn btn-xs btn-danger',\n        id: 'btn-danger',\n        callback: deleteData\n      }]\n    });\n\n    WUI.DataPaginator.create({\n      $el: $('.data-paginator'),\n      currentPage: options.currentPage - 1,\n      total: resp.totalCount,\n      pageSize: options.pageSize,\n      onSwitchPage: function (currentPage) {\n        queryData({\n          currentPage: currentPage + 1,\n          pageSize: options.pageSize\n        });\n      }\n    });\n  });\n};\n\n// Load Page\nWUI.ready = function () {\n  // meta的元素数据字典 => cloumn数据 => 查询数据\n  queryDictionary('label');\n\n  // 面包屑\n  WUI.ContentHeader.create({\n    $el: $('.content-header'),\n    meta: [{\n      name: '标签'\n    }]\n  });\n}\n// Keep this function\n$(function () {\n  WUI.init({\n    system: 'cmdb'\n  });\n});\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJjbWRiL2xhYmVsLWxpc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuLy8gQ29uc3RhbnRzXG52YXIgQ01EQl9BUEkgPSB7XG4gIHF1ZXJ5RGljdGlvbmFyeTogJy93ZWIvcXVlcnlEaWN0aW9uYXJ5JywgLy8g5pWw5o2u5a2X5YW4XG4gIGFkZDogJy93ZWIvYWRkTGFiZWwnLCAvLyDlop5cbiAgZGVsZXRlOiAnL3dlYi9kZWxldGVMYWJlbHMnLCAvLyDliKBcbiAgdXBkYXRlOiAnL3dlYi91cGRhdGVMYWJlbCcsIC8vIOaUuVxuICBjb2x1bW46ICcvd2ViL2xhYmVsL2NvbHVtbicsIC8vIOafpeivouadoeS7tlxuICBxdWVyeTogJy93ZWIvbGFiZWwvcXVlcnknLCAvLyDmn6VcbiAgZXhwb3J0OiAnL3dlYi9leGNlbC9kb3dubG9hZC9sYWJlbCcsIC8vIGV4cG9ydFxuICBpbXBvcnQ6ICcvd2ViL2V4Y2VsL3VwbG9hZC9sYWJlbCcgLy8gaW1wb3J0XG59O1xuTUVUQVsnY29kZSddID0geyBsYWJlbDogJ+agh+etvl9jb2RlJywgcmVxdWlyZWQ6IHRydWUsIG1heExlbmd0aDozMCB9O1xudmFyIEVESVRfRklFTERTID0gWydsYWJlbF9rZXknLCAnbGFiZWxfdmFsdWUnLCAnc3RhdHVzJywgJ2Rlc2NyaXB0aW9uJ107XG5cbnZhciBzZWxlY3RBcnkgPSBbJ3N0YXR1cyddO1xudmFyIGNyZWF0ZURhdGEgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAvLyDliJ3lp4vljJZzZWxlY3RcbiAgJC5lYWNoKHNlbGVjdEFyeSxmdW5jdGlvbihpLCBlKXtcbiAgICBmb3IodmFyIGo9MDtqPE1FVEFbZV0ub3B0aW9ucy5sZW5ndGg7aisrKXtcbiAgICAgIGlmIChNRVRBW2VdLm9wdGlvbnNbal0ubGFiZWwgPT0gaXRlbVtlXSkge1xuICAgICAgICBNRVRBW2VdLm9wdGlvbnNbal0uc2VsZWN0ID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIE1FVEFbZV0ub3B0aW9uc1tqXS5zZWxlY3QgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIFdVSS5Nb2RhbERpYWxvZy5jcmVhdGUoe1xuICAgIGJ1dHRvbkhpZGU6IHRydWUsXG4gIH0pO1xuXG4gIFdVSS5kYXRhRGlhbG9nLmNyZWF0ZSh7XG4gICAgJGVsOiAkKCcubW9kYWwtYm9keScpLFxuICAgIGRpYWxvZ1BvcDp0cnVlLFxuICAgIG1ldGE6IE1FVEEsXG4gICAgbGlzdDogaXRlbSxcbiAgICBidXR0b25IaWRlOiBmYWxzZSxcbiAgICBvbkNvbmZpcm06IHN1Ym1pdERhdGEuYmluZChudWxsLCBpdGVtKSxcbiAgICBmaWVsZHM6IEVESVRfRklFTERTXG4gIH0pO1xufTtcbnF1ZXJ5RGF0YSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gIHZhciBfYmVmb3JlU2VuZCA9IGZ1bmN0aW9uKHJlcXVlc3QpIHtcbiAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoXCJwYWdlTnVtXCIsIG9wdGlvbnMuY3VycmVudFBhZ2UpO1xuICAgIHJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcihcInBhZ2VMaW1pdFwiLCBvcHRpb25zLnBhZ2VTaXplKTtcbiAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoXCJBdXRob3JpemF0aW9uXCIsIGdldENvb2tpZSgnQ01EQi1UT0tFTi1UWVBFJykgKycgJysgZ2V0Q29va2llKCdDTURCLVRPS0VOJykpO1xuICB9O1xuICBcbiAgV1VJLmFqYXgoe1xuICAgIHVybDogRE9NQUlOLkNNREIgKyBDTURCX0FQSS5xdWVyeSxcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBqc29uRGF0YTogcXVlcnlKc29uKCksXG4gICAgZGlzYWJsZVhTUzogdHJ1ZSxcbiAgICBiZWZvcmVTZW5kOiBfYmVmb3JlU2VuZFxuICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XG4gICAgV1VJLkRhdGFUYWJsZS5jcmVhdGUoe1xuICAgICAgJGVsOiAkKCcuZGF0YS10YWJsZScpLFxuICAgICAgbWV0YTogTUVUQSxcbiAgICAgIGZpZWxkczogVEFCTEVfRklFTERTLFxuICAgICAgbGlzdDogcmVzcC5saXN0LFxuICAgICAgb3BlcmF0aW9uczogW3tcbiAgICAgICAgbmFtZTogJ+e8lui+kScsXG4gICAgICAgIGNhbGxiYWNrOiBjcmVhdGVEYXRhXG4gICAgICB9LCB7XG4gICAgICAgIG5hbWU6ICfliKDpmaQnLFxuICAgICAgICBjYWxsYmFjazogZGVsZXRlRGF0YVxuICAgICAgfV0sXG4gICAgICBncm91cHM6IFt7XG4gICAgICAgIG5hbWU6ICfmibnph4/liKDpmaQnLFxuICAgICAgICBjbGFzc05hbWU6ICdidG4gYnRuLXhzIGJ0bi1kYW5nZXInLFxuICAgICAgICBpZDogJ2J0bi1kYW5nZXInLFxuICAgICAgICBjYWxsYmFjazogZGVsZXRlRGF0YVxuICAgICAgfV1cbiAgICB9KTtcblxuICAgIFdVSS5EYXRhUGFnaW5hdG9yLmNyZWF0ZSh7XG4gICAgICAkZWw6ICQoJy5kYXRhLXBhZ2luYXRvcicpLFxuICAgICAgY3VycmVudFBhZ2U6IG9wdGlvbnMuY3VycmVudFBhZ2UgLSAxLFxuICAgICAgdG90YWw6IHJlc3AudG90YWxDb3VudCxcbiAgICAgIHBhZ2VTaXplOiBvcHRpb25zLnBhZ2VTaXplLFxuICAgICAgb25Td2l0Y2hQYWdlOiBmdW5jdGlvbiAoY3VycmVudFBhZ2UpIHtcbiAgICAgICAgcXVlcnlEYXRhKHtcbiAgICAgICAgICBjdXJyZW50UGFnZTogY3VycmVudFBhZ2UgKyAxLFxuICAgICAgICAgIHBhZ2VTaXplOiBvcHRpb25zLnBhZ2VTaXplXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn07XG5cbi8vIExvYWQgUGFnZVxuV1VJLnJlYWR5ID0gZnVuY3Rpb24gKCkge1xuICAvLyBtZXRh55qE5YWD57Sg5pWw5o2u5a2X5YW4ID0+IGNsb3VtbuaVsOaNriA9PiDmn6Xor6LmlbDmja5cbiAgcXVlcnlEaWN0aW9uYXJ5KCdsYWJlbCcpO1xuXG4gIC8vIOmdouWMheWxkVxuICBXVUkuQ29udGVudEhlYWRlci5jcmVhdGUoe1xuICAgICRlbDogJCgnLmNvbnRlbnQtaGVhZGVyJyksXG4gICAgbWV0YTogW3tcbiAgICAgIG5hbWU6ICfmoIfnrb4nXG4gICAgfV1cbiAgfSk7XG59XG4vLyBLZWVwIHRoaXMgZnVuY3Rpb25cbiQoZnVuY3Rpb24gKCkge1xuICBXVUkuaW5pdCh7XG4gICAgc3lzdGVtOiAnY21kYidcbiAgfSk7XG59KTtcbiJdLCJmaWxlIjoiY21kYi9sYWJlbC1saXN0LmpzIn0=\n"]}