{"version":3,"sources":["cmdb/dictionary-list.js"],"names":["CMDB_API","queryDictionary","add","delete","update","column","query","export","import","META","label","required","maxLength","type","options","dictionaryJson","EDIT_FIELDS","selectAry","createData","item","table_name","_name","$","each","i","e","_option","value","push","j","length","select","WUI","ModalDialog","create","buttonHide","dataDialog","$el","dialogPop","meta","list","onConfirm","submitData","bind","fields","_code","trim","val","_table","_column","_value","_url","id","ajax","url","DOMAIN","CMDB","method","then","resp","remove","removeClass","queryData","currentPage","pageSize","PAGE_SIZE","fail","_beforeSend","request","setRequestHeader","getCookie","jsonData","queryJson","disableXSS","beforeSend","DataTable","TABLE_FIELDS","operations","name","callback","deleteData","groups","className","DataPaginator","total","totalCount","onSwitchPage","ready","queryColumn","document","on","this","empty","_rowHtml","html","join","ContentHeader","init","system"],"mappings":"AAAA,YAEA,IAAIA,WACFC,gBAAiB,uBACjBC,IAAK,iCACLC,SAAQ,yBACRC,OAAQ,iCACRC,OAAQ,yBACRC,MAAO,wBACPC,SAAQ,iCACRC,SAAQ,+BAEVC,MAAW,MAAMC,MAAO,YAAaC,UAAU,EAAMC,UAAU,IAC/DH,KAAc,SAAMC,MAAO,IAAKE,UAAU,IAC1CH,KAAiB,YAAMC,MAAO,KAAMG,KAAM,SAAUC,YACpDL,KAAkB,aAAMC,MAAO,KAAMG,KAAM,SAAUC,WACrD,IAAIC,mBACAC,aAAe,OAAQ,aAAc,cAAe,WAEpDC,WAAa,aAAc,eAC3BC,WAAa,SAAUC,GACzB,GAAKA,EAAKC,WAAW,CACnB,GAAIC,GAAQF,EAAKC,UACjBX,MAAkB,YAAEK,WACpBQ,EAAEC,KAAKR,eAAeM,GAAQ,SAASG,EAAGC,GACxC,GAAIC,IACFhB,MAAOe,EACPE,MAAOF,EAEThB,MAAkB,YAAEK,QAAQc,KAAKF,SAEhC,CACH,GAAIL,GAAQZ,KAAiB,WAAEK,QAAQ,GAAGa,KAC1ClB,MAAkB,YAAEK,WACpBQ,EAAEC,KAAKR,eAAeM,GAAQ,SAASG,EAAGC,GACxC,GAAIC,IACFhB,MAAOe,EACPE,MAAOF,EAEThB,MAAkB,YAAEK,QAAQc,KAAKF,KAIrCJ,EAAEC,KAAKN,UAAU,SAASO,EAAGC,GAC3B,IAAI,GAAII,GAAE,EAAEA,EAAEpB,KAAKgB,GAAGX,QAAQgB,OAAOD,IAC/BpB,KAAKgB,GAAGX,QAAQe,GAAGnB,OAASS,EAAKM,GACnChB,KAAKgB,GAAGX,QAAQe,GAAGE,QAAS,EAE5BtB,KAAKgB,GAAGX,QAAQe,GAAGE,QAAS,IAKlCC,IAAIC,YAAYC,QACdC,YAAY,IAGdH,IAAII,WAAWF,QACbG,IAAKf,EAAE,eACPgB,WAAU,EACVC,KAAM9B,KACN+B,KAAMrB,EACNgB,YAAY,EACZM,UAAWC,WAAWC,KAAK,KAAMxB,GACjCyB,OAAQ5B,cAGZ0B,YAAa,SAASvB,GACpB,GAAI0B,GAAQvB,EAAEwB,KAAKxB,EAAE,6CAA6CyB,OAC9DC,EAAS1B,EAAE,oDAAoDyB,MAC/DE,EAAU3B,EAAE,qDAAqDyB,MACjEG,EAAS5B,EAAEwB,KAAKxB,EAAE,gDAAgDyB,OAClEI,EAAOnD,SAASE,IAAK,UAAW8C,EAAQ,WAAYC,EAAS,UAAWC,EAAQ,SAAUL,CACzF1B,GAAKiC,KACRD,EAAOnD,SAASI,OAAQ,UAAW4C,EAAQ,WAAYC,EAAS,UAAWC,EAAQ,SAAUL,EAAO,OAAQ1B,EAAKiC,IAEnHpB,IAAIqB,MACFC,IAAKC,OAAOC,KAAOL,EACnBM,OAAQ,SACPC,KAAK,SAAUC,GAChBrC,EAAE,iCAAiCsC,SACnCtC,EAAE,QAAQuC,YAAY,cACtBC,WACEC,YAAa,EACbC,SAAUC,cAEXC,KAAK,SAASP,GACfrC,EAAE,iCAAiCsC,YAGvCE,UAAY,SAAUhD,GACpB,GAAIqD,GAAc,SAASC,GACzBA,EAAQC,iBAAiB,UAAWvD,EAAQiD,aAC5CK,EAAQC,iBAAiB,YAAavD,EAAQkD,UAC9CI,EAAQC,iBAAiB,gBAAiBC,UAAU,mBAAoB,IAAKA,UAAU,eAGzFtC,KAAIqB,MACFC,IAAKC,OAAOC,KAAOxD,SAASM,MAC5BmD,OAAQ,OACRc,SAAUC,YACVC,YAAY,EACZC,WAAYP,IACXT,KAAK,SAAUC,GAChB3B,IAAI2C,UAAUzC,QACZG,IAAKf,EAAE,eACPiB,KAAM9B,KACNmC,OAAQgC,aACRpC,KAAMmB,EAAKnB,KACXqC,aACEC,KAAM,KACNC,SAAU7D,aAEV4D,KAAM,KACNC,SAAUC,aAEZC,SACEH,KAAM,OACNI,UAAW,wBACX9B,GAAI,aACJ2B,SAAUC,eAIdhD,IAAImD,cAAcjD,QAChBG,IAAKf,EAAE,mBACPyC,YAAajD,EAAQiD,YAAc,EACnCqB,MAAOzB,EAAK0B,WACZrB,SAAUlD,EAAQkD,SAClBsB,aAAc,SAAUvB,GACtBD,WACEC,YAAaA,EAAc,EAC3BC,SAAUlD,EAAQkD,iBAQ5BhC,IAAIuD,MAAQ,WAEVvD,IAAIqB,MACFC,IAAKC,OAAOC,KAAO,+BACnBC,OAAQ,SACPC,KAAK,SAAUC,GAChB5C,eAAiB4C,EACjBrC,EAAEC,KAAKoC,EAAM,SAASnC,GACpB,GAAIE,IACFhB,MAAOc,EACPG,MAAOH,EAETf,MAAiB,WAAEK,QAAQc,KAAKF,OAEjCgC,KAAK8B,aAERlE,EAAEmE,UAAUC,GAAG,SAAU,0BAA2B,WAClD,GAAIrE,GAAQC,EAAEqE,MAAM5C,KACpBzB,GAAE,4BAA4BsE,QAC9BnF,KAAkB,YAAEK,UACpB,IAAI+E,KACJvE,GAAEC,KAAKR,eAAeM,GAAQ,SAASG,EAAGC,GACxC,GAAIC,IACFhB,MAAOe,EACPE,MAAOF,EAEThB,MAAkB,YAAEK,QAAQc,KAAKF,GACjCmE,EAASjE,KAAK,kBAAmBH,EAAG,KAAMA,EAAG,eAE/CH,EAAE,4BAA4BwE,KAAKD,EAASE,KAAK,OAInD/D,IAAIgE,cAAc9D,QAChBG,IAAKf,EAAE,mBACPiB,OACEuC,KAAM,cAKZxD,EAAE,WACAU,IAAIiE,MACFC,OAAQ","file":"dictionary-list.js","sourcesContent":["'use strict';\n// Constants\nvar CMDB_API = {\n  queryDictionary: '/web/queryDictionary', // 数据字典\n  add: '/web/dictionary/ex/addOrUpdate', // 增\n  delete: '/web/deleteDictionarys', // 删\n  update: '/web/dictionary/ex/addOrUpdate', // 改\n  column: '/web/dictionary/column', // 查询条件\n  query: '/web/dictionary/query', // 查\n  export: '/web/excel/download/dictionary', // export\n  import: '/web/excel/upload/dictionary' // import\n};\nMETA['code'] = { label: '数据字典_code', required: true, maxLength:30 };\nMETA['content'] = { label: '值', maxLength:30 };\nMETA['table_name'] = { label: '大类', type: 'select', options: [] };\nMETA['column_name'] = { label: '小类', type: 'select', options: [] };\nvar dictionaryJson = {};\nvar EDIT_FIELDS = ['code', 'table_name', 'column_name', 'content'];\n\nvar selectAry = ['table_name', 'column_name'];\nvar createData = function (item) {\n  if(!!item.table_name){\n    var _name = item.table_name;\n    META['column_name'].options = [];\n    $.each(dictionaryJson[_name], function(i, e){\n      var _option = {\n        label: e,\n        value: e\n      }\n      META['column_name'].options.push(_option);\n    });\n  }else{\n    var _name = META['table_name'].options[0].value;\n    META['column_name'].options = [];\n    $.each(dictionaryJson[_name], function(i, e){\n      var _option = {\n        label: e,\n        value: e\n      }\n      META['column_name'].options.push(_option);\n    });\n  }\n  // 初始化select\n  $.each(selectAry,function(i, e){\n    for(var j=0;j<META[e].options.length;j++){\n      if (META[e].options[j].label == item[e]) {\n        META[e].options[j].select = true;\n      } else {\n        META[e].options[j].select = false;\n      }\n    }\n  });\n\n  WUI.ModalDialog.create({\n    buttonHide: true,\n  });\n\n  WUI.dataDialog.create({\n    $el: $('.modal-body'),\n    dialogPop:true,\n    meta: META,\n    list: item,\n    buttonHide: false,\n    onConfirm: submitData.bind(null, item),\n    fields: EDIT_FIELDS\n  });\n};\nsubmitData = function(item){\n  var _code = $.trim($('#html-dialog .modal-body input[name=code]').val());\n  var _table = $('#html-dialog .modal-body select[name=table_name]').val();\n  var _column = $('#html-dialog .modal-body select[name=column_name]').val();\n  var _value = $.trim($('#html-dialog .modal-body input[name=content]').val());\n  var _url = CMDB_API.add +'?table='+ _table +'&column='+ _column +'&value='+ _value +'&code='+ _code;\n  if(!!item.id){\n    _url = CMDB_API.update +'?table='+ _table +'&column='+ _column +'&value='+ _value +'&code='+ _code +'&id='+ item.id;\n  }\n  WUI.ajax({\n    url: DOMAIN.CMDB + _url,\n    method: 'POST'\n  }).then(function (resp) {\n    $('#html-dialog, .modal-backdrop').remove();\n    $('body').removeClass('modal-open');\n    queryData({\n      currentPage: 1,\n      pageSize: PAGE_SIZE\n    });\n  }).fail(function(resp){\n    $('#html-dialog, .modal-backdrop').remove();\n  });\n};\nqueryData = function (options) {\n  var _beforeSend = function(request) {\n    request.setRequestHeader(\"pageNum\", options.currentPage);\n    request.setRequestHeader(\"pageLimit\", options.pageSize);\n    request.setRequestHeader(\"Authorization\", getCookie('CMDB-TOKEN-TYPE') +' '+ getCookie('CMDB-TOKEN'));\n  };\n  \n  WUI.ajax({\n    url: DOMAIN.CMDB + CMDB_API.query,\n    method: 'POST',\n    jsonData: queryJson(),\n    disableXSS: true,\n    beforeSend: _beforeSend\n  }).then(function (resp) {\n    WUI.DataTable.create({\n      $el: $('.data-table'),\n      meta: META,\n      fields: TABLE_FIELDS,\n      list: resp.list,\n      operations: [{\n        name: '编辑',\n        callback: createData\n      }, {\n        name: '删除',\n        callback: deleteData\n      }],\n      groups: [{\n        name: '批量删除',\n        className: 'btn btn-xs btn-danger',\n        id: 'btn-danger',\n        callback: deleteData\n      }]\n    });\n\n    WUI.DataPaginator.create({\n      $el: $('.data-paginator'),\n      currentPage: options.currentPage - 1,\n      total: resp.totalCount,\n      pageSize: options.pageSize,\n      onSwitchPage: function (currentPage) {\n        queryData({\n          currentPage: currentPage + 1,\n          pageSize: options.pageSize\n        });\n      }\n    });\n  });\n};\n\n// Load Page\nWUI.ready = function () {\n  // meta的元素数据字典 => cloumn数据 => 查询数据\n  WUI.ajax({\n    url: DOMAIN.CMDB + '/web/dictionary/ex/allTables',\n    method: 'POST'\n  }).then(function (resp) {\n    dictionaryJson = resp;\n    $.each(resp, function(i){\n      var _option = {\n        label: i,\n        value: i\n      }\n      META['table_name'].options.push(_option);\n    });\n  }).then(queryColumn);\n\n  $(document).on('change', 'select[name=table_name]', function(){\n    var _name = $(this).val();\n    $('select[name=column_name]').empty();\n    META['column_name'].options = [];\n    var _rowHtml = [];\n    $.each(dictionaryJson[_name], function(i, e){\n      var _option = {\n        label: e,\n        value: e\n      }\n      META['column_name'].options.push(_option);\n      _rowHtml.push('<option value=\"'+ e +'\">'+ e +'</option>');\n    });\n    $('select[name=column_name]').html(_rowHtml.join(''));\n  });\n\n  // 面包屑\n  WUI.ContentHeader.create({\n    $el: $('.content-header'),\n    meta: [{\n      name: '数据字典维护'\n    }]\n  });\n}\n// Keep this function\n$(function () {\n  WUI.init({\n    system: 'cmdb'\n  });\n});\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJjbWRiL2RpY3Rpb25hcnktbGlzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG4vLyBDb25zdGFudHNcbnZhciBDTURCX0FQSSA9IHtcbiAgcXVlcnlEaWN0aW9uYXJ5OiAnL3dlYi9xdWVyeURpY3Rpb25hcnknLCAvLyDmlbDmja7lrZflhbhcbiAgYWRkOiAnL3dlYi9kaWN0aW9uYXJ5L2V4L2FkZE9yVXBkYXRlJywgLy8g5aKeXG4gIGRlbGV0ZTogJy93ZWIvZGVsZXRlRGljdGlvbmFyeXMnLCAvLyDliKBcbiAgdXBkYXRlOiAnL3dlYi9kaWN0aW9uYXJ5L2V4L2FkZE9yVXBkYXRlJywgLy8g5pS5XG4gIGNvbHVtbjogJy93ZWIvZGljdGlvbmFyeS9jb2x1bW4nLCAvLyDmn6Xor6LmnaHku7ZcbiAgcXVlcnk6ICcvd2ViL2RpY3Rpb25hcnkvcXVlcnknLCAvLyDmn6VcbiAgZXhwb3J0OiAnL3dlYi9leGNlbC9kb3dubG9hZC9kaWN0aW9uYXJ5JywgLy8gZXhwb3J0XG4gIGltcG9ydDogJy93ZWIvZXhjZWwvdXBsb2FkL2RpY3Rpb25hcnknIC8vIGltcG9ydFxufTtcbk1FVEFbJ2NvZGUnXSA9IHsgbGFiZWw6ICfmlbDmja7lrZflhbhfY29kZScsIHJlcXVpcmVkOiB0cnVlLCBtYXhMZW5ndGg6MzAgfTtcbk1FVEFbJ2NvbnRlbnQnXSA9IHsgbGFiZWw6ICflgLwnLCBtYXhMZW5ndGg6MzAgfTtcbk1FVEFbJ3RhYmxlX25hbWUnXSA9IHsgbGFiZWw6ICflpKfnsbsnLCB0eXBlOiAnc2VsZWN0Jywgb3B0aW9uczogW10gfTtcbk1FVEFbJ2NvbHVtbl9uYW1lJ10gPSB7IGxhYmVsOiAn5bCP57G7JywgdHlwZTogJ3NlbGVjdCcsIG9wdGlvbnM6IFtdIH07XG52YXIgZGljdGlvbmFyeUpzb24gPSB7fTtcbnZhciBFRElUX0ZJRUxEUyA9IFsnY29kZScsICd0YWJsZV9uYW1lJywgJ2NvbHVtbl9uYW1lJywgJ2NvbnRlbnQnXTtcblxudmFyIHNlbGVjdEFyeSA9IFsndGFibGVfbmFtZScsICdjb2x1bW5fbmFtZSddO1xudmFyIGNyZWF0ZURhdGEgPSBmdW5jdGlvbiAoaXRlbSkge1xuICBpZighIWl0ZW0udGFibGVfbmFtZSl7XG4gICAgdmFyIF9uYW1lID0gaXRlbS50YWJsZV9uYW1lO1xuICAgIE1FVEFbJ2NvbHVtbl9uYW1lJ10ub3B0aW9ucyA9IFtdO1xuICAgICQuZWFjaChkaWN0aW9uYXJ5SnNvbltfbmFtZV0sIGZ1bmN0aW9uKGksIGUpe1xuICAgICAgdmFyIF9vcHRpb24gPSB7XG4gICAgICAgIGxhYmVsOiBlLFxuICAgICAgICB2YWx1ZTogZVxuICAgICAgfVxuICAgICAgTUVUQVsnY29sdW1uX25hbWUnXS5vcHRpb25zLnB1c2goX29wdGlvbik7XG4gICAgfSk7XG4gIH1lbHNle1xuICAgIHZhciBfbmFtZSA9IE1FVEFbJ3RhYmxlX25hbWUnXS5vcHRpb25zWzBdLnZhbHVlO1xuICAgIE1FVEFbJ2NvbHVtbl9uYW1lJ10ub3B0aW9ucyA9IFtdO1xuICAgICQuZWFjaChkaWN0aW9uYXJ5SnNvbltfbmFtZV0sIGZ1bmN0aW9uKGksIGUpe1xuICAgICAgdmFyIF9vcHRpb24gPSB7XG4gICAgICAgIGxhYmVsOiBlLFxuICAgICAgICB2YWx1ZTogZVxuICAgICAgfVxuICAgICAgTUVUQVsnY29sdW1uX25hbWUnXS5vcHRpb25zLnB1c2goX29wdGlvbik7XG4gICAgfSk7XG4gIH1cbiAgLy8g5Yid5aeL5YyWc2VsZWN0XG4gICQuZWFjaChzZWxlY3RBcnksZnVuY3Rpb24oaSwgZSl7XG4gICAgZm9yKHZhciBqPTA7ajxNRVRBW2VdLm9wdGlvbnMubGVuZ3RoO2orKyl7XG4gICAgICBpZiAoTUVUQVtlXS5vcHRpb25zW2pdLmxhYmVsID09IGl0ZW1bZV0pIHtcbiAgICAgICAgTUVUQVtlXS5vcHRpb25zW2pdLnNlbGVjdCA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBNRVRBW2VdLm9wdGlvbnNbal0uc2VsZWN0ID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICBXVUkuTW9kYWxEaWFsb2cuY3JlYXRlKHtcbiAgICBidXR0b25IaWRlOiB0cnVlLFxuICB9KTtcblxuICBXVUkuZGF0YURpYWxvZy5jcmVhdGUoe1xuICAgICRlbDogJCgnLm1vZGFsLWJvZHknKSxcbiAgICBkaWFsb2dQb3A6dHJ1ZSxcbiAgICBtZXRhOiBNRVRBLFxuICAgIGxpc3Q6IGl0ZW0sXG4gICAgYnV0dG9uSGlkZTogZmFsc2UsXG4gICAgb25Db25maXJtOiBzdWJtaXREYXRhLmJpbmQobnVsbCwgaXRlbSksXG4gICAgZmllbGRzOiBFRElUX0ZJRUxEU1xuICB9KTtcbn07XG5zdWJtaXREYXRhID0gZnVuY3Rpb24oaXRlbSl7XG4gIHZhciBfY29kZSA9ICQudHJpbSgkKCcjaHRtbC1kaWFsb2cgLm1vZGFsLWJvZHkgaW5wdXRbbmFtZT1jb2RlXScpLnZhbCgpKTtcbiAgdmFyIF90YWJsZSA9ICQoJyNodG1sLWRpYWxvZyAubW9kYWwtYm9keSBzZWxlY3RbbmFtZT10YWJsZV9uYW1lXScpLnZhbCgpO1xuICB2YXIgX2NvbHVtbiA9ICQoJyNodG1sLWRpYWxvZyAubW9kYWwtYm9keSBzZWxlY3RbbmFtZT1jb2x1bW5fbmFtZV0nKS52YWwoKTtcbiAgdmFyIF92YWx1ZSA9ICQudHJpbSgkKCcjaHRtbC1kaWFsb2cgLm1vZGFsLWJvZHkgaW5wdXRbbmFtZT1jb250ZW50XScpLnZhbCgpKTtcbiAgdmFyIF91cmwgPSBDTURCX0FQSS5hZGQgKyc/dGFibGU9JysgX3RhYmxlICsnJmNvbHVtbj0nKyBfY29sdW1uICsnJnZhbHVlPScrIF92YWx1ZSArJyZjb2RlPScrIF9jb2RlO1xuICBpZighIWl0ZW0uaWQpe1xuICAgIF91cmwgPSBDTURCX0FQSS51cGRhdGUgKyc/dGFibGU9JysgX3RhYmxlICsnJmNvbHVtbj0nKyBfY29sdW1uICsnJnZhbHVlPScrIF92YWx1ZSArJyZjb2RlPScrIF9jb2RlICsnJmlkPScrIGl0ZW0uaWQ7XG4gIH1cbiAgV1VJLmFqYXgoe1xuICAgIHVybDogRE9NQUlOLkNNREIgKyBfdXJsLFxuICAgIG1ldGhvZDogJ1BPU1QnXG4gIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcbiAgICAkKCcjaHRtbC1kaWFsb2csIC5tb2RhbC1iYWNrZHJvcCcpLnJlbW92ZSgpO1xuICAgICQoJ2JvZHknKS5yZW1vdmVDbGFzcygnbW9kYWwtb3BlbicpO1xuICAgIHF1ZXJ5RGF0YSh7XG4gICAgICBjdXJyZW50UGFnZTogMSxcbiAgICAgIHBhZ2VTaXplOiBQQUdFX1NJWkVcbiAgICB9KTtcbiAgfSkuZmFpbChmdW5jdGlvbihyZXNwKXtcbiAgICAkKCcjaHRtbC1kaWFsb2csIC5tb2RhbC1iYWNrZHJvcCcpLnJlbW92ZSgpO1xuICB9KTtcbn07XG5xdWVyeURhdGEgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICB2YXIgX2JlZm9yZVNlbmQgPSBmdW5jdGlvbihyZXF1ZXN0KSB7XG4gICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKFwicGFnZU51bVwiLCBvcHRpb25zLmN1cnJlbnRQYWdlKTtcbiAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoXCJwYWdlTGltaXRcIiwgb3B0aW9ucy5wYWdlU2l6ZSk7XG4gICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKFwiQXV0aG9yaXphdGlvblwiLCBnZXRDb29raWUoJ0NNREItVE9LRU4tVFlQRScpICsnICcrIGdldENvb2tpZSgnQ01EQi1UT0tFTicpKTtcbiAgfTtcbiAgXG4gIFdVSS5hamF4KHtcbiAgICB1cmw6IERPTUFJTi5DTURCICsgQ01EQl9BUEkucXVlcnksXG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAganNvbkRhdGE6IHF1ZXJ5SnNvbigpLFxuICAgIGRpc2FibGVYU1M6IHRydWUsXG4gICAgYmVmb3JlU2VuZDogX2JlZm9yZVNlbmRcbiAgfSkudGhlbihmdW5jdGlvbiAocmVzcCkge1xuICAgIFdVSS5EYXRhVGFibGUuY3JlYXRlKHtcbiAgICAgICRlbDogJCgnLmRhdGEtdGFibGUnKSxcbiAgICAgIG1ldGE6IE1FVEEsXG4gICAgICBmaWVsZHM6IFRBQkxFX0ZJRUxEUyxcbiAgICAgIGxpc3Q6IHJlc3AubGlzdCxcbiAgICAgIG9wZXJhdGlvbnM6IFt7XG4gICAgICAgIG5hbWU6ICfnvJbovpEnLFxuICAgICAgICBjYWxsYmFjazogY3JlYXRlRGF0YVxuICAgICAgfSwge1xuICAgICAgICBuYW1lOiAn5Yig6ZmkJyxcbiAgICAgICAgY2FsbGJhY2s6IGRlbGV0ZURhdGFcbiAgICAgIH1dLFxuICAgICAgZ3JvdXBzOiBbe1xuICAgICAgICBuYW1lOiAn5om56YeP5Yig6ZmkJyxcbiAgICAgICAgY2xhc3NOYW1lOiAnYnRuIGJ0bi14cyBidG4tZGFuZ2VyJyxcbiAgICAgICAgaWQ6ICdidG4tZGFuZ2VyJyxcbiAgICAgICAgY2FsbGJhY2s6IGRlbGV0ZURhdGFcbiAgICAgIH1dXG4gICAgfSk7XG5cbiAgICBXVUkuRGF0YVBhZ2luYXRvci5jcmVhdGUoe1xuICAgICAgJGVsOiAkKCcuZGF0YS1wYWdpbmF0b3InKSxcbiAgICAgIGN1cnJlbnRQYWdlOiBvcHRpb25zLmN1cnJlbnRQYWdlIC0gMSxcbiAgICAgIHRvdGFsOiByZXNwLnRvdGFsQ291bnQsXG4gICAgICBwYWdlU2l6ZTogb3B0aW9ucy5wYWdlU2l6ZSxcbiAgICAgIG9uU3dpdGNoUGFnZTogZnVuY3Rpb24gKGN1cnJlbnRQYWdlKSB7XG4gICAgICAgIHF1ZXJ5RGF0YSh7XG4gICAgICAgICAgY3VycmVudFBhZ2U6IGN1cnJlbnRQYWdlICsgMSxcbiAgICAgICAgICBwYWdlU2l6ZTogb3B0aW9ucy5wYWdlU2l6ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG4vLyBMb2FkIFBhZ2VcbldVSS5yZWFkeSA9IGZ1bmN0aW9uICgpIHtcbiAgLy8gbWV0YeeahOWFg+e0oOaVsOaNruWtl+WFuCA9PiBjbG91bW7mlbDmja4gPT4g5p+l6K+i5pWw5o2uXG4gIFdVSS5hamF4KHtcbiAgICB1cmw6IERPTUFJTi5DTURCICsgJy93ZWIvZGljdGlvbmFyeS9leC9hbGxUYWJsZXMnLFxuICAgIG1ldGhvZDogJ1BPU1QnXG4gIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcbiAgICBkaWN0aW9uYXJ5SnNvbiA9IHJlc3A7XG4gICAgJC5lYWNoKHJlc3AsIGZ1bmN0aW9uKGkpe1xuICAgICAgdmFyIF9vcHRpb24gPSB7XG4gICAgICAgIGxhYmVsOiBpLFxuICAgICAgICB2YWx1ZTogaVxuICAgICAgfVxuICAgICAgTUVUQVsndGFibGVfbmFtZSddLm9wdGlvbnMucHVzaChfb3B0aW9uKTtcbiAgICB9KTtcbiAgfSkudGhlbihxdWVyeUNvbHVtbik7XG5cbiAgJChkb2N1bWVudCkub24oJ2NoYW5nZScsICdzZWxlY3RbbmFtZT10YWJsZV9uYW1lXScsIGZ1bmN0aW9uKCl7XG4gICAgdmFyIF9uYW1lID0gJCh0aGlzKS52YWwoKTtcbiAgICAkKCdzZWxlY3RbbmFtZT1jb2x1bW5fbmFtZV0nKS5lbXB0eSgpO1xuICAgIE1FVEFbJ2NvbHVtbl9uYW1lJ10ub3B0aW9ucyA9IFtdO1xuICAgIHZhciBfcm93SHRtbCA9IFtdO1xuICAgICQuZWFjaChkaWN0aW9uYXJ5SnNvbltfbmFtZV0sIGZ1bmN0aW9uKGksIGUpe1xuICAgICAgdmFyIF9vcHRpb24gPSB7XG4gICAgICAgIGxhYmVsOiBlLFxuICAgICAgICB2YWx1ZTogZVxuICAgICAgfVxuICAgICAgTUVUQVsnY29sdW1uX25hbWUnXS5vcHRpb25zLnB1c2goX29wdGlvbik7XG4gICAgICBfcm93SHRtbC5wdXNoKCc8b3B0aW9uIHZhbHVlPVwiJysgZSArJ1wiPicrIGUgKyc8L29wdGlvbj4nKTtcbiAgICB9KTtcbiAgICAkKCdzZWxlY3RbbmFtZT1jb2x1bW5fbmFtZV0nKS5odG1sKF9yb3dIdG1sLmpvaW4oJycpKTtcbiAgfSk7XG5cbiAgLy8g6Z2i5YyF5bGRXG4gIFdVSS5Db250ZW50SGVhZGVyLmNyZWF0ZSh7XG4gICAgJGVsOiAkKCcuY29udGVudC1oZWFkZXInKSxcbiAgICBtZXRhOiBbe1xuICAgICAgbmFtZTogJ+aVsOaNruWtl+WFuOe7tOaKpCdcbiAgICB9XVxuICB9KTtcbn1cbi8vIEtlZXAgdGhpcyBmdW5jdGlvblxuJChmdW5jdGlvbiAoKSB7XG4gIFdVSS5pbml0KHtcbiAgICBzeXN0ZW06ICdjbWRiJ1xuICB9KTtcbn0pO1xuIl0sImZpbGUiOiJjbWRiL2RpY3Rpb25hcnktbGlzdC5qcyJ9\n"]}